
开场白
镜头一
在三维世界中，每一个物体的位置和方向都由一个统一的空间系统来描述，称为世界坐标系。眼前的神庙模型位于这个三维坐标系中的某一位置。我们所看到的图像，并非三维场景本身，而是通过一块被称为“相机视口”的平面，将三维信息投影到二维空间上所呈现的结果。这块视口，相当于相机的屏幕，神庙如何出现在其中，取决于相机的位置、朝向，以及投影方式。随着相机的位置不断变化，我们观察到屏幕中的神庙图像也在发生变化，时而变大，时而变小，这是透视投影带来的结果。那么，神庙是如何从空间中的一个三维模型，最终呈现在二维屏幕上的呢？本期将从这个问题出发，探讨三维图形中最基础但也最关键的过程之一：从世界坐标到屏幕坐标的转换过程。

分镜头二
为了探索这个问题，我们首先需要了解空间中各个变量的几何位置和它们之间的相对关系。
这是一个点，称为P零，表示相机的位置，也就是相机坐标系的原点。它在三维空间中的坐标是x零，y零，z零。
我们接下来标出相机的视线方向，也就是从P零指向目标点Q的方向。这个方向定义为相机局部坐标系中的y轴。
然后，我们通过计算叉积来确定相机的x轴。我们将视线方向与竖直方向，也就是世界坐标中的向上方向，零一零，进行叉积，得到一个与它们都垂直的方向，这个方向就是相机的x轴。
接着，我们再做一次叉积，把刚刚求得的x轴方向和y轴方向进行叉积，结果就是相机的z轴，也就是同时垂直于前两个方向的向量。
这三个互相垂直的方向向量，也就是x，y，z三个轴，共同组成了相机的局部坐标系。
我们可以将它们排列成一个三乘三的旋转矩阵，用来描述相机的朝向。
现在来看另一个点，称为P，它在空间中的坐标是x，y，z。我们可以从相机原点P零，画一条指向P的虚线，这条线长度我们称为步长，用字母t表示。
接下来，我们希望知道这个点P被投影到屏幕上之后的位置，也就是它在屏幕上的二维坐标。x prime和y prime。
那么问题就变成了，已知空间中点P的位置，还有相机的旋转矩阵以及相机原点，我们该如何计算步长t，以及它在屏幕上的投影坐标x prime和y prime。

分镜头三
好了，我们已经知道了空间中各个点和变量的位置。接下来，我们要把它们放进方程，开始求解。首先，我们有这样一个公式。相机原点P_0，加上步长t，乘以旋转矩阵，再乘以一个列向量。这个向量的三个分量分别是x prime，第二个是数字一，第三个是y prime。这个计算的结果，就是目标点P在三维空间中的坐标。
接下来，我们把相机原点挪到等号右边，变成目标点减去相机原点。这表示目标点相对于相机位置的空间偏移。于是我们有了一个新的表达式。步长t，乘以旋转矩阵，再乘以列向量x prime、一、和y prime，等于目标点减去相机原点。
我们可以把步长t和屏幕坐标合并成一个新的三维向量。这个向量的分量是t乘以x prime，t本身，以及t乘以y prime。在这个向量左边乘以旋转矩阵R，等于目标点减去相机原点。
为了进一步求解这个向量，我们对这个表达式左右两边同时乘以旋转矩阵R的逆矩阵。结果左边变成t乘以列向量，右边是旋转矩阵的逆，乘以目标点减去相机原点。
因为这个三维向量中间的那一项就是t，所以我们可以从中间一项直接解出步长t。具体来说，我们先取行向量零、一、零，也就是只保留中间那一维。用它去乘以旋转矩阵的逆，再乘以目标点和相机原点的差，就得到了步长t的值。
有了t，我们可以将它代入公式，再通过除法操作，计算出屏幕上的投影坐标x prime和y prime。计算方法是。用一个矩阵，这个矩阵第一行是一、零、零，第二行是零、零、一，然后乘以旋转矩阵R的逆，再乘以目标点减去相机原点，最后除以步长t。然后得到的列向量就是屏幕上的投影坐标x prime和y prime
这样，我们就完成了从三维空间坐标到屏幕投影坐标的整个推导过程。


分镜头四
好了，经过刚才的讲解，我们已经掌握了空间点转换到屏幕坐标的方法。
如果你喜欢这期内容，别忘了给我点个赞，订阅频道，还有转发给你觉得需要的小伙伴。谢谢大家支持，我们下期见！




